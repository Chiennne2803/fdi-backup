<div class="flex flex-col max-w-240 w-120 max-h-screen -m-6">

    <!-- Header -->
    <div class="flex flex-0 items-center justify-between h-16 pr-3 sm:pr-5 pl-6 sm:pl-8 bg-primary text-on-primary">
        <div class="text-lg font-medium uppercase">Đầu tư tự chọn</div>
        <button mat-icon-button
                tabindex="-1">
            <mat-icon class="text-current"
                      [svgIcon]="'heroicons_outline:x'"
                      (click)="discard()"></mat-icon>
        </button>
    </div>

    <!-- Compose form -->
    <ng-container>
        <form class="flex flex-col flex-auto p-5 overflow-y-auto"
              [formGroup]="investForm">
            <!-- Info -->
            <div class="flex flex-col p-4 mb-4"
                 *ngIf="data">
                <div class="flex flex-row w-full gap-4 mb-5">
                    <article class="prose break-words">
                        <p>Số dư khả dụng: <br> <span class="text-primary text-3xl">{{ data.prepareData.wlEu |
                                currencyFormatPipe: 10 }} VND</span></p>
                    </article>
                </div>
                <div class="flex flex-row w-full gap-4 mb-5">
                    <article class="prose break-words">
                        <p>Số tiền có thể đầu tư: <br> <b>{{ data.prepareData.remainingAmount | currencyFormatPipe: 10
                                }} VND</b></p>
                    </article>
                </div>
                <div class="flex flex-row w-full gap-4 mb-5">
                    <article class="prose break-words">
                        <p>Kỳ hạn(ngày): <br> <b>{{ data.prepareData.investorTime }}</b></p>
                    </article>
                </div>
                <div class="flex flex-row w-full gap-4 mb-5">
                    <mat-form-field class="w-full">
                        <mat-label>Số tiền đầu tư (VNĐ)</mat-label>
                        <input id="amount"
                               tabindex="1"
                               [maxlength]="15"
                               matInput
                               currencyMask autocomplete="off"
                               class="text-left"
                               [options]="{ prefix: '', thousands: ',', precision: 0, allowNegative: false }"
                               formControlName="amount">
                        <mat-error *ngIf="investForm.get('amount').hasError('required')">
                            {{ 'INVM20003' | transloco }}
                        </mat-error>
                        <mat-error *ngIf="investForm.get('amount').hasError('min')">
                            {{ 'INVM20013' | transloco }}
                        </mat-error>
                        <mat-error *ngIf="investForm.get('amount').value > data.prepareData.wlEu">
                            {{ 'INVM20006' | transloco }}
                        </mat-error>
                        <mat-error *ngIf="investForm.get('amount').value > data.prepareData.remainingAmount">
                            {{ 'INVM20007' | transloco }}
                        </mat-error>
                    </mat-form-field>
                </div>
                <div class="flex flex-row w-full gap-4 mb-5">
                    <article class="prose break-words">
                        <p>Lãi dự kiến: <br> <b>{{ interestEstimate | currencyFormatPipe : 10 }} VND</b></p>
                    </article>
                </div>
                <mat-checkbox formControlName="isTrusted"
                              [color]="'primary'">
                    <div
                         [class]="investForm.get('isTrusted').touched && investForm.get('isTrusted').hasError('required') ? 'text-red-700' : ''">
                        Tôi xác nhận đã đọc, hiểu và đồng ý với các điều khoản và điều kiện của <button
                                class="text-blue-700 underline"
                                type="reset"
                                (click)="downloadContract()">Hợp đồng tài trợ vốn</button>
                    </div>
                </mat-checkbox>
            </div>
        </form>
    </ng-container>
    <!-- Actions -->
    <div class="flex flex-col sm:flex-row sm:items-center justify-center mb-4 sm:mb-6">
        <div class="flex items-center mt-4 sm:mt-0">
            <button class="order-first sm:order-last"
                    mat-flat-button
                    [color]="'primary'"
                    (click)="onSubmit()">
                Xác nhận đầu tư
            </button>
        </div>
    </div>
</div>
