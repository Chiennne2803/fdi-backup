<div mat-dialog-title>
    <div class="flex justify-between">
        <h2>Lập yêu cầu giải ngân</h2>
        <a
            mat-dialog-close
            mat-icon-button>
            <mat-icon [svgIcon]="'heroicons_outline:x'"></mat-icon>
        </a>
    </div>
</div>
<mat-dialog-content>
    <article class="prose mb-5">
        <h3>Thông tin hồ sơ</h3>
    </article>
    <div class="flex flex-col flex-auto overflow-hidden sm:overflow-y-auto">
        <div class="grid grid-cols-2 gap-5">
            <mat-form-field
                class="w-full">
                <mat-label>Mã yêu cầu giải ngân</mat-label>
                <input matInput [value]="prepareDisbursementRequest.fsCardDown.transCode" readonly>
            </mat-form-field>
            <mat-form-field
                class="w-full">
                <mat-label>Trạng thái</mat-label>
<!--                <input matInput [value]="fsCardDownStatusTextMap[prepareDisbursementRequest.fsCardDown.status]" readonly>-->
            </mat-form-field>
            <mat-form-field
                class="w-full">
                <mat-label>Hồ sơ cần giải ngân</mat-label>
                <input matInput [value]="prepareDisbursementRequest.fsCardDown.fsLoanProfilesId.toString()" readonly>
            </mat-form-field>
            <mat-form-field
                class="w-full">
                <mat-label>Chọn khoản đầu tư cần giải ngân</mat-label>
                <mat-select [formControl]="selectInvestorsFC" multiple (ngModelChange)="onSelectInvestor($event)">
                    <mat-select-trigger>Chọn</mat-select-trigger>
                    <mat-option
                        *ngFor="let investor of prepareDisbursementRequest.investors"
                        [value]="investor.fsTransInvestorId"
                        class="min-h-15"
                    >
                        {{investor.fullName}} {{ " - " }}
                        {{investor.amount | currencyFormatPipe: 10}} VND
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field
                class="w-full">
                <mat-label>Người lập</mat-label>
                <input matInput [value]="authService.authenticatedUser.accountName" readonly>
            </mat-form-field>
            <mat-form-field
                class="flex-auto">
                <mat-label>Ngày lập</mat-label>
                <input
                    readonly
                    matInput
                    [matDatepicker]="datePicker"
                    [max]="currentDate"
                    [(ngModel)]="date"
                >
                <mat-datepicker-toggle
                    matSuffix
                    [for]="datePicker"></mat-datepicker-toggle>
                <mat-datepicker #datePicker></mat-datepicker>
            </mat-form-field>
        </div>

        <table mat-table [dataSource]="selectedInvestors" *ngIf="selectedInvestors.length > 0">
            <ng-container matColumnDef="index">
                <th mat-header-cell *matHeaderCellDef>
                    <div class="cell-overflow table-header">
                        STT
                    </div>
                </th>
                <td mat-cell *matCellDef="let element; let j = index">
                    <div class="cell-overflow">
                        {{j + 1}}
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="fullName">
                <th mat-header-cell *matHeaderCellDef>
                    <div class="cell-overflow table-header">
                        Nhà đầu tư
                    </div>
                </th>
                <td mat-cell *matCellDef="let element">
                    <div class="cell-overflow">
                        {{ element.fullName }}
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="amount">
                <th mat-header-cell *matHeaderCellDef>
                    <div class="cell-overflow table-header">
                        Số tiền đầu tư
                    </div>
                </th>
                <td mat-cell *matCellDef="let element">
                    <div class="cell-overflow">
                        {{ element.amount | currencyFormatPipe : 10 }}
                    </div>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['index', 'fullName', 'amount']"></tr>
            <tr
                mat-row *matRowDef="let row; columns: ['index', 'fullName', 'amount'];"
                class="hover:bg-accent-50 hover:cursor-pointer"></tr>
        </table>
    </div>
</mat-dialog-content>
<mat-dialog-actions align="end">
    <button mat-stroked-button mat-dialog-close>Đóng</button>
    <button mat-flat-button color="primary" (click)="submit()">Lập yêu cầu</button>
</mat-dialog-actions>
